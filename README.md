# Deep learning 預測股價

##### 前言: 由於近期 chatgpt 實在火紅，本以為十幾年後才能看到的人工智慧如今橫空出世，因此萌生想學習其背後的深度學習的框架

##### 透過學習其一的框架: pytorch 後，想以該技術，試圖以利用深度學習來預測股價走勢，因此有該 side project

![](https://i.imgur.com/J7uL7xD.png)![docker](https://i.imgur.com/GpxYNoe.png+) ![pytorch](https://i.imgur.com/LwzDTfH.png)![](https://i.imgur.com/cADpkK3.png) ![](https://i.imgur.com/ILx6OWB.png)

## 目的: 希望透過深度學習的技術，預測股價走勢

醜話說在前頭，股市的走勢，很重要的還是得透過**基本面、籌碼面、市場概況**得以預估，從不認為可以簡簡單單就可以達成

因此此次的 side project 純粹以練習該框架，學習神經網路等相關知識，就算最後預測失敗，也不失一個學習的經驗

## 主要步驟

#### 1. 透過 LSTM 觀察股價是否得以根據過往的價格進行有效預測

#### 2. 使用 ANN 搭配有意義的 feature 進行訓練與預測

#### 3. 使用步驟二產的預測結果進行獲利計算

#### 4. 若有效則設定相關自動化流程來通知進場或出場

---

### 1. LSTM: 長短期記憶模型

主要用於長序列的訓練，負責記憶過去訊息，並刪除無用的記憶，更新當前記憶及輸出預測值

可用於去處理語言句子進行前文分析及預測下一句該怎麼講，其實就是 chatgpt 的精隨，只是別人多了更多的語言監督跟更複雜的訓練而成

這裡取其中 LSTM 的模型來協助預測長序列的資料，如股價，因此這裡先用 LSTM 進行預測分析

#### 相關程式碼請參考: lstmModel.py

> 這裡以個人覺得值得投資的標的 QQQ(ETF)作為股價預測的標的
>
> 抓取時間為過去 20 年，利用過去 19 年預測近一年的股價表現

![lstm1](https://i.imgur.com/0665Ogn.png)

###### 注意: 此處每個預測的資料，皆是以滾動式，拿取過往"真實"的 90 天資料進行預測第 91 天的資料，只是記錄了 LSTM 的預測結果，並沒有拿該預測結果作為 input 進行預測

#### 看起來挺貼合真實的股價表現，但其實只是滯後的表現，也就是真實股價先行後，預測的結果才慢慢跟上

> 畢竟 LSTM 是根據過往的股價表現，去推估未來的股價，若過往的股價從 1 -> 2 -> 3 ，是很容易推估下一個可能是 4.01
>
> 但影響股價的因素眾多，很多時候都是價格優先反映真實市場狀況，而這個當下模型是不會知道的，得等到隔天後才有辦法納入
>
> 因此仔細來看 LSTM 預測的股價是遞延於真實股價 => 也就是追漲殺跌，對於投資上幫助不大

![lstm2](https://i.imgur.com/rfNWLkf.png)

#### 這裡則使用過往 90 天的股價，慢慢替換成預測的股價作為 input 去預測更久遠未來的股價

> 完全失效 => 不可能僅憑 LSTM 的模型去預測未來股價的走勢
>
> 後續的股價如心跳停止的表現，皆已跌加預測誤差了，因此儘管 LOSS 沒有隨著 epoch 持續下降，也已經預測失效了

### 結論: 使用 LSTM 去預測股價是不切實際的，因為股價他並不是單純透過過往歷史股價表現就能輕鬆預測，參雜了各種因素去影響股價，而使用 LSTM 去預測句子算行得通

> 如: 今晚，我想吃.... 若經過足夠的訓練，是可以回答得出來像是"泡麵" / "義大利麵" / "金黃火腿"等，因為這些大多可以依循著固定的**語言順序**進行訓練

#### 股價並沒有固定的表現，至於常常聽到的股價會歷史重演...，很多時候都是講這句話的人，大多擷取過往對他有利的股價片段，而忽略了整個股價的表現跟隨機走勢沒兩樣

> 我說明天會漲，50%的機率是對的我就拿那 50%的機率證明我很厲害..... 這種感覺

---
